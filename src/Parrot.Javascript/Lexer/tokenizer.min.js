var Tokenizer=function(){function n(n){this._source=n,this._currentIndex=0}return n.Prototype.hasAvailableTokens=function(){return this._currentIndex<this._source.Length},n.Prototype.Peek=function(){return this._source.charAt(this._currentIndex)},n.Prototype.Consume=function(){if(this._currentIndex>=this._source.Length)throw new EndOfStreamException;var n=this._source.charAt(this._currentIndex);return this._currentIndex++,n},n.Prototype.ConsumeIdentifier=function(){for(var t="",n=this.Peek();this.IsIdTail(n);)this.Consume(),t+=n,n=this.Peek();return t},n.Prototype.ConsumeWhitespace=function(){for(var t="",n=this.Peek();this.IsWhitespace(n);)this.Consume(),t+=n,n=this.Peek();return t},n.Prototype.ConsumeUntilNewLineOrEndOfStream=function(){for(var t="",n=this.Peek();!this.IsNewLine(n);)try{this.Consume(),t+=n,n=this.Peek()}catch(i){break}return t},n.Prototype.ConsumeQuotedStringLiteral=function(n){for(var i=this.Consume(),t=this.Peek();;){while(t!=n)this.Consume(),i+=t,t=this.Peek();if(i+=this.Consume(),this.Peek()!=n)break;this.Consume(),t=this.Peek()}return i},n.Prototype.IsNewLine=function(n){return n=="\r"||n=="\n"},n.Prototype.getNextToken=function(){var n;if(this.hasAvailableTokens()){if(n=this.Peek(),this.IsIdentifierHead(n))return new IdentifierToken(this._currentIndex,this.ConsumeIdentifier(),TokenType.Identifier);if(this.IsWhitespace(n))return new WhitespaceToken(this._currentIndex,this.ConsumeWhitespace(),TokenType.Whitespace);switch(n){case",":return this.Consume(),new CommaToken(this._currentIndex);case"(":return this.Consume(),new OpenParenthesisToken(this._currentIndex);case")":return this.Consume(),new CloseParenthesisToken(this._currentIndex);case"[":return this.Consume(),new OpenBracketToken(this._currentIndex);case"]":return this.Consume(),new CloseBracketToken(this._currentIndex);case"=":return this.Consume(),new EqualToken(this._currentIndex);case"{":return this.Consume(),new OpenBracesToken(this._currentIndex);case"}":return this.Consume(),new CloseBracesToken(this._currentIndex);case">":return this.Consume(),new GreaterThanToken(this._currentIndex);case"+":return this.Consume(),new PlusToken(this._currentIndex);case"|":return new StringLiteralPipeToken(this._currentIndex,this.ConsumeUntilNewLineOrEndOfStream());case'"':return new QuotedStringLiteralToken(this._currentIndex,this.ConsumeQuotedStringLiteral('"'));case"'":return new QuotedStringLiteralToken(this._currentIndex,this.ConsumeQuotedStringLiteral("'"));case"@":return this.Consume(),new AtToken(this._currentIndex);case'\0':return null;default:throw new UnexpectedTokenException("Unexpected token: "+n);}}return null},n.Prototype.IsWhitespace=function(n){return n=="\r"||n=="\n"||n==" "||n=="\f"||n=="\t"||n=="\x0b"},n.Prototype.IsIdentifierHead=function(n){return n.Match(/[a-zA-Z]/)||n=="_"||n=="#"||n=="."},n.Prototype.IsIdTail=function(n){return n.Match(/[0-9]/)||this.IsIdentifierHead(n)||n==":"||n=="-"},n.Prototype.Tokenize=function(){for(var n,t=[];(n=this.getNextToken())!=null;)t.Push(n);return t},n.Prototype.Tokens=function(){return this.Tokenize()},n}(),EndOfStreamException=function(){function n(){this.Message="Unexpected end of stream"}return n}(),UnexpectedTokenException=function(){function n(n){this.Message=n}return n}()
